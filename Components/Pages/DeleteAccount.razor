@page "/deleteAccount"
@rendermode InteractiveServer
@using CactusFrontEnd.Security
@using Messenger
@using MessengerInterfaces
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedLocalStorage ProtectedLocalStore
@inherits AuthorizedPage

<PageTitle>Delete Account</PageTitle>

<h1>Delete Account</h1>

Deleting your Account can't be undone. <br/>
<input type="button" value="Delete my Account" @onclick=@deleteAccountClick/>

@code {
	[Inject]
	NavigationManager navigationManager { get; set; }
	[Inject]
	IMessengerService messengerService { get; set; }

	protected async override void OnAfterRender(bool firstRender)
	{
		if (firstRender)
		{
			await this.Initialize(() => navigationManager.NavigateTo($"logout"));
		}
	}

	private async Task deleteAccountClick()
	{
		await messengerService.DeleteAccount(user.Id);
		navigationManager.NavigateTo($"logout");
	}
}